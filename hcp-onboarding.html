<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Products Setup - Housecall Pro</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* HCP Theme Colors */
            --primary-main: #1976D2;
            --primary-light: #42A5F5;
            --primary-dark: #1565C0;
            --secondary-main: #757575;
            --secondary-light: #BDBDBD;
            --text-primary: #212121;
            --text-secondary: #757575;
            --background-default: #FAFAFA;
            --background-paper: #FFFFFF;
            --divider: rgba(0, 0, 0, 0.12);
            --success-main: #4CAF50;
            --success-light: #E8F5E9;
            --warning-main: #FF9800;
            --warning-light: #FFF3E0;
            --error-main: #F44336;
            --grey-100: #F5F5F5;
            --grey-300: #E0E0E0;
            --grey-400: #BDBDBD;
            --grey-600: #757575;
            --grey-900: #212121;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--background-default);
            color: var(--text-primary);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* Navigation Bar (matches HCP) */
        .top-nav {
            background: var(--grey-900);
            color: white;
            height: 64px;
            display: flex;
            align-items: center;
            padding: 0 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .top-nav-logo {
            font-size: 20px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .top-nav-logo .material-icons {
            font-size: 28px;
            color: var(--primary-light);
        }

        .main-content {
            margin-top: 64px;
            padding: 32px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Breadcrumbs (HCP style) */
        .breadcrumbs {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 24px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .breadcrumbs .material-icons {
            font-size: 16px;
        }

        .breadcrumb-link {
            color: var(--text-secondary);
            text-decoration: none;
        }

        .breadcrumb-link:hover {
            color: var(--primary-main);
        }

        /* Card (Material Design) */
        .card {
            background: var(--background-paper);
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            padding: 24px;
            margin-bottom: 24px;
        }

        .card-large {
            padding: 48px;
        }

        /* Typography */
        h1 {
            font-size: 34px;
            font-weight: 400;
            line-height: 1.2;
            margin-bottom: 8px;
        }

        h2 {
            font-size: 24px;
            font-weight: 400;
            line-height: 1.3;
            margin-bottom: 16px;
        }

        h5 {
            font-size: 20px;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 16px;
        }

        .subtitle1 {
            font-size: 16px;
            font-weight: 500;
            line-height: 1.5;
        }

        .body1 {
            font-size: 16px;
            font-weight: 400;
            line-height: 1.5;
        }

        .body2 {
            font-size: 14px;
            font-weight: 400;
            line-height: 1.43;
        }

        .caption {
            font-size: 12px;
            font-weight: 400;
            line-height: 1.66;
            color: var(--text-secondary);
        }

        .text-secondary {
            color: var(--text-secondary);
        }

        /* Stepper (HCP style) */
        .stepper {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 48px;
            padding: 0 24px;
        }

        .stepper-step {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stepper-circle {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            border: 2px solid var(--grey-400);
            color: var(--text-secondary);
            background: var(--background-paper);
        }

        .stepper-circle.active {
            background: var(--primary-main);
            color: white;
            border-color: var(--primary-main);
        }

        .stepper-circle.completed {
            background: var(--success-main);
            color: white;
            border-color: var(--success-main);
        }

        .stepper-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            min-width: 80px;
            text-align: center;
        }

        .stepper-label.active {
            color: var(--primary-main);
        }

        .stepper-connector {
            width: 40px;
            height: 2px;
            background: var(--grey-300);
            margin: 0 8px;
        }

        .stepper-connector.completed {
            background: var(--success-main);
        }

        /* Buttons */
        .button {
            padding: 8px 22px;
            font-size: 14px;
            font-weight: 500;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.02857em;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .button-contained {
            background: var(--primary-main);
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .button-contained:hover {
            background: var(--primary-dark);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .button-outlined {
            background: transparent;
            color: var(--primary-main);
            border: 1px solid var(--primary-main);
        }

        .button-outlined:hover {
            background: rgba(25, 118, 210, 0.04);
        }

        .button-text {
            background: transparent;
            color: var(--primary-main);
        }

        .button-text:hover {
            background: rgba(25, 118, 210, 0.04);
        }

        .button:disabled {
            background: var(--grey-300);
            color: var(--grey-600);
            cursor: not-allowed;
            box-shadow: none;
        }

        .button-group {
            display: flex;
            gap: 16px;
            justify-content: flex-end;
            margin-top: 32px;
        }

        /* Form Controls */
        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--grey-400);
            border-radius: 4px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-main);
            box-shadow: 0 0 0 1px var(--primary-main);
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            cursor: pointer;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .checkbox-wrapper:hover {
            background: var(--grey-100);
        }

        .checkbox-input {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        /* Service List */
        .service-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .service-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: var(--background-paper);
            border: 1px solid var(--grey-300);
            border-radius: 4px;
            transition: all 0.2s;
        }

        .service-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .service-item.disabled {
            opacity: 0.5;
        }

        .service-info {
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
        }

        .drag-handle {
            color: var(--grey-400);
            cursor: grab;
        }

        .drag-handle:active {
            cursor: grabbing;
        }

        .service-details {
            flex: 1;
        }

        .service-name {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .service-meta {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .service-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        /* Schedule Grid */
        .schedule-grid {
            display: grid;
            gap: 16px;
        }

        .schedule-day {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: var(--grey-100);
            border-radius: 4px;
        }

        .schedule-day-name {
            font-weight: 500;
            min-width: 100px;
        }

        .schedule-times {
            display: flex;
            gap: 8px;
            align-items: center;
            flex: 1;
        }

        .time-input {
            padding: 8px;
            border: 1px solid var(--grey-400);
            border-radius: 4px;
            font-size: 14px;
            width: 120px;
        }

        /* Team Member Cards */
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 16px;
        }

        .team-card {
            padding: 20px;
            background: var(--background-paper);
            border: 1px solid var(--grey-300);
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .team-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: 500;
        }

        /* Product Cards */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }

        .product-card {
            padding: 24px;
            background: var(--background-paper);
            border: 2px solid var(--grey-300);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .product-card:hover {
            border-color: var(--primary-main);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .product-card.selected {
            border-color: var(--primary-main);
            background: rgba(25, 118, 210, 0.04);
        }

        .product-icon {
            width: 48px;
            height: 48px;
            background: var(--primary-light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
        }

        .product-icon .material-icons {
            font-size: 28px;
            color: white;
        }

        .product-name {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .product-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* AI Coach */
        .ai-coach {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 380px;
            background: var(--background-paper);
            border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            overflow: hidden;
            z-index: 900;
            display: none;
        }

        .ai-coach.visible {
            display: block;
        }

        .ai-coach-header {
            background: var(--primary-main);
            color: white;
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-coach-header h6 {
            font-size: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-coach-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px;
        }

        .ai-coach-body {
            padding: 16px;
            max-height: 400px;
            overflow-y: auto;
        }

        .ai-message {
            background: var(--grey-100);
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 12px;
            font-size: 14px;
            line-height: 1.5;
        }

        .ai-input-wrapper {
            padding: 16px;
            border-top: 1px solid var(--divider);
            display: flex;
            gap: 8px;
        }

        .ai-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--grey-400);
            border-radius: 4px;
            font-size: 14px;
        }

        /* Toggle Button */
        .ai-toggle-button {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--primary-main);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 899;
        }

        .ai-toggle-button:hover {
            background: var(--primary-dark);
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .mt-24 {
            margin-top: 24px;
        }

        .mb-16 {
            margin-bottom: 16px;
        }

        .text-center {
            text-align: center;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                padding: 16px;
            }

            .stepper {
                flex-direction: column;
                align-items: flex-start;
            }

            .stepper-connector {
                width: 2px;
                height: 40px;
                margin: 8px 0;
            }

            .product-grid {
                grid-template-columns: 1fr;
            }

            .ai-coach {
                width: calc(100% - 32px);
                right: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="top-nav-logo">
            <span class="material-icons">home_repair_service</span>
            <span>Housecall Pro</span>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Breadcrumbs -->
        <div class="breadcrumbs">
            <a href="#" class="breadcrumb-link">Settings</a>
            <span class="material-icons">chevron_right</span>
            <a href="#" class="breadcrumb-link">Booking</a>
            <span class="material-icons">chevron_right</span>
            <span>Setup</span>
        </div>

        <!-- Stepper -->
        <div class="stepper" id="stepper"></div>

        <!-- Content -->
        <div id="content"></div>
    </div>

    <!-- AI Coach Toggle -->
    <button class="ai-toggle-button" onclick="toggleAICoach()">
        <span class="material-icons">smart_toy</span>
    </button>

    <!-- AI Coach -->
    <div class="ai-coach" id="aiCoach">
        <div class="ai-coach-header">
            <h6>
                <span class="material-icons">smart_toy</span>
                AI Setup Coach
            </h6>
            <button class="ai-coach-close" onclick="toggleAICoach()">
                <span class="material-icons">close</span>
            </button>
        </div>
        <div class="ai-coach-body" id="aiCoachBody">
            <div class="ai-message">
                Hi! I'm your AI Setup Coach. I'm here to help you configure your booking products. Ask me anything!
            </div>
        </div>
        <div class="ai-input-wrapper">
            <input type="text" class="ai-input" id="aiInput" placeholder="Ask me anything..." onkeypress="handleAIInput(event)">
            <button class="button button-contained" onclick="sendAIMessage()">
                <span class="material-icons">send</span>
            </button>
        </div>
    </div>

    <script>
        // State
        let currentStep = 0;
        let services = [
            { id: 1, name: 'AC Repair', price: 150, duration: 90, enabled: true },
            { id: 2, name: 'Heating Service', price: 120, duration: 60, enabled: true },
            { id: 3, name: 'Maintenance Check', price: 85, duration: 45, enabled: true },
            { id: 4, name: 'Installation', price: 500, duration: 240, enabled: false },
            { id: 5, name: 'Emergency Service', price: 200, duration: 120, enabled: true }
        ];
        let selectedProducts = [];
        let teamMembers = [
            { id: 1, name: 'John Smith', initials: 'JS', available: true },
            { id: 2, name: 'Sarah Johnson', initials: 'SJ', available: true },
            { id: 3, name: 'Mike Davis', initials: 'MD', available: false }
        ];
        let schedule = {
            monday: { enabled: true, start: '08:00', end: '17:00' },
            tuesday: { enabled: true, start: '08:00', end: '17:00' },
            wednesday: { enabled: true, start: '08:00', end: '17:00' },
            thursday: { enabled: true, start: '08:00', end: '17:00' },
            friday: { enabled: true, start: '08:00', end: '17:00' },
            saturday: { enabled: false, start: '09:00', end: '13:00' },
            sunday: { enabled: false, start: '09:00', end: '13:00' }
        };

        const steps = [
            { name: 'Welcome', render: renderWelcome },
            { name: 'Services', render: renderServices },
            { name: 'Hours', render: renderHours },
            { name: 'Team', render: renderTeam },
            { name: 'Products', render: renderProducts },
            { name: 'Setup', render: renderSetup },
            { name: 'Done', render: renderDone }
        ];

        // Initialize
        function init() {
            renderStepper();
            renderStep();
        }

        // Render Stepper
        function renderStepper() {
            const stepper = document.getElementById('stepper');
            stepper.innerHTML = steps.map((step, index) => {
                const isActive = index === currentStep;
                const isCompleted = index < currentStep;
                const showConnector = index < steps.length - 1;

                return `
                    <div class="stepper-step">
                        <div>
                            <div class="stepper-circle ${isActive ? 'active' : ''} ${isCompleted ? 'completed' : ''}">
                                ${isCompleted ? '<span class="material-icons" style="font-size: 20px;">check</span>' : index + 1}
                            </div>
                            <div class="stepper-label ${isActive ? 'active' : ''}">${step.name}</div>
                        </div>
                    </div>
                    ${showConnector ? `<div class="stepper-connector ${isCompleted ? 'completed' : ''}"></div>` : ''}
                `;
            }).join('');
        }

        // Render Current Step
        function renderStep() {
            const content = document.getElementById('content');
            content.innerHTML = '';
            steps[currentStep].render();
            renderStepper();
        }

        // Navigation
        function nextStep() {
            if (currentStep < steps.length - 1) {
                currentStep++;
                renderStep();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                renderStep();
            }
        }

        // Step Renderers
        function renderWelcome() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="card card-large text-center">
                    <h1>Welcome to Booking Products Setup</h1>
                    <p class="body1 text-secondary" style="margin: 16px 0 32px;">
                        Let's set up your booking products in just a few steps. This will only take 5-10 minutes.
                    </p>
                    <div class="product-grid" style="text-align: left; margin-top: 32px;">
                        <div class="card">
                            <div class="product-icon">
                                <span class="material-icons">calendar_today</span>
                            </div>
                            <h5>Online Booking</h5>
                            <p class="body2 text-secondary">Let customers book appointments 24/7 from your website</p>
                        </div>
                        <div class="card">
                            <div class="product-icon">
                                <span class="material-icons">phone</span>
                            </div>
                            <h5>CSR AI</h5>
                            <p class="body2 text-secondary">AI-powered phone answering to handle customer calls</p>
                        </div>
                        <div class="card">
                            <div class="product-icon">
                                <span class="material-icons">route</span>
                            </div>
                            <h5>Smart Scheduling</h5>
                            <p class="body2 text-secondary">Optimize routes and automatically assign jobs to your team</p>
                        </div>
                        <div class="card">
                            <div class="product-icon">
                                <span class="material-icons">support_agent</span>
                            </div>
                            <h5>HCP Assist</h5>
                            <p class="body2 text-secondary">Live customer support with real agents (paid add-on)</p>
                        </div>
                    </div>
                    <div class="button-group" style="justify-content: center; margin-top: 48px;">
                        <button class="button button-contained" onclick="nextStep()">
                            Get Started
                            <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function renderServices() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="card">
                    <h2>Select Your Services</h2>
                    <p class="body2 text-secondary mb-16">Choose which services you want to offer for online booking. You can reorder them by dragging.</p>

                    <div class="form-group">
                        <input type="text" class="form-input" placeholder="Search services..." id="serviceSearch" oninput="filterServices()">
                    </div>

                    <div class="service-list" id="serviceList">
                        ${services.map(service => `
                            <div class="service-item ${!service.enabled ? 'disabled' : ''}" data-id="${service.id}">
                                <div class="service-info">
                                    <span class="material-icons drag-handle">drag_indicator</span>
                                    <div class="service-details">
                                        <div class="service-name">${service.name}</div>
                                        <div class="service-meta">$${service.price} • ${service.duration} min</div>
                                    </div>
                                </div>
                                <div class="service-actions">
                                    <label class="checkbox-wrapper" style="margin: 0;">
                                        <input type="checkbox" class="checkbox-input" ${service.enabled ? 'checked' : ''} onchange="toggleService(${service.id})">
                                    </label>
                                    <button class="button button-text" onclick="editService(${service.id})">
                                        <span class="material-icons">edit</span>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <button class="button button-outlined mt-24" onclick="addService()">
                        <span class="material-icons">add</span>
                        Add Service
                    </button>

                    <div class="button-group">
                        <button class="button button-text" onclick="prevStep()">Back</button>
                        <button class="button button-contained" onclick="nextStep()">
                            Continue
                            <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function renderHours() {
            const content = document.getElementById('content');
            const days = Object.keys(schedule);

            content.innerHTML = `
                <div class="card">
                    <h2>Set Your Availability</h2>
                    <p class="body2 text-secondary mb-16">Define when customers can book appointments with you.</p>

                    <div class="schedule-grid">
                        ${days.map(day => `
                            <div class="schedule-day">
                                <label class="checkbox-wrapper" style="margin: 0;">
                                    <input type="checkbox" class="checkbox-input" ${schedule[day].enabled ? 'checked' : ''} onchange="toggleDay('${day}')">
                                    <span class="schedule-day-name">${day.charAt(0).toUpperCase() + day.slice(1)}</span>
                                </label>
                                <div class="schedule-times">
                                    <input type="time" class="time-input" value="${schedule[day].start}" ${!schedule[day].enabled ? 'disabled' : ''} onchange="updateTime('${day}', 'start', this.value)">
                                    <span>to</span>
                                    <input type="time" class="time-input" value="${schedule[day].end}" ${!schedule[day].enabled ? 'disabled' : ''} onchange="updateTime('${day}', 'end', this.value)">
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="button-group">
                        <button class="button button-text" onclick="prevStep()">Back</button>
                        <button class="button button-contained" onclick="nextStep()">
                            Continue
                            <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function renderTeam() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="card">
                    <h2>Your Team</h2>
                    <p class="body2 text-secondary mb-16">Manage which team members can take bookings.</p>

                    <div class="team-grid">
                        ${teamMembers.map(member => `
                            <div class="team-card">
                                <div class="team-avatar">${member.initials}</div>
                                <div>
                                    <div class="subtitle1">${member.name}</div>
                                    <div class="caption">${member.available ? 'Available' : 'Not available'}</div>
                                </div>
                                <label class="checkbox-wrapper" style="margin: 0;">
                                    <input type="checkbox" class="checkbox-input" ${member.available ? 'checked' : ''} onchange="toggleTeamMember(${member.id})">
                                    <span class="body2">Available for bookings</span>
                                </label>
                            </div>
                        `).join('')}
                    </div>

                    <div class="button-group">
                        <button class="button button-text" onclick="prevStep()">Back</button>
                        <button class="button button-contained" onclick="nextStep()">
                            Continue
                            <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function renderProducts() {
            const content = document.getElementById('content');
            const products = [
                { id: 'online_booking', name: 'Online Booking', icon: 'calendar_today', desc: 'Let customers book appointments 24/7' },
                { id: 'csr_ai', name: 'CSR AI', icon: 'phone', desc: 'AI-powered phone answering' },
                { id: 'smart_scheduling', name: 'Smart Scheduling', icon: 'route', desc: 'Optimize routes and assignments' },
                { id: 'hcp_assist', name: 'HCP Assist', icon: 'support_agent', desc: 'Live customer support (paid add-on)' }
            ];

            content.innerHTML = `
                <div class="card">
                    <h2>Choose Your Products</h2>
                    <p class="body2 text-secondary mb-16">Select which booking products you want to enable.</p>

                    <div class="product-grid">
                        ${products.map(product => `
                            <div class="product-card ${selectedProducts.includes(product.id) ? 'selected' : ''}" onclick="toggleProduct('${product.id}')">
                                <div class="product-icon">
                                    <span class="material-icons">${product.icon}</span>
                                </div>
                                <div class="product-name">${product.name}</div>
                                <div class="product-description">${product.desc}</div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="button-group">
                        <button class="button button-text" onclick="prevStep()">Back</button>
                        <button class="button button-contained" onclick="nextStep()" ${selectedProducts.length === 0 ? 'disabled' : ''}>
                            Continue
                            <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function renderSetup() {
            const content = document.getElementById('content');
            const enabledServices = services.filter(s => s.enabled);
            const enabledDays = Object.keys(schedule).filter(day => schedule[day].enabled);
            const availableTeam = teamMembers.filter(m => m.available);

            content.innerHTML = `
                <div class="card">
                    <h2>Review Your Setup</h2>
                    <p class="body2 text-secondary mb-16">Review your configuration before we activate your booking products.</p>

                    <div class="card" style="background: var(--grey-100); margin-top: 24px;">
                        <h5>Services (${enabledServices.length})</h5>
                        <ul style="list-style: none; padding: 0;">
                            ${enabledServices.slice(0, 3).map(s => `<li class="body2">✓ ${s.name} - $${s.price}</li>`).join('')}
                            ${enabledServices.length > 3 ? `<li class="body2">+ ${enabledServices.length - 3} more</li>` : ''}
                        </ul>
                    </div>

                    <div class="card" style="background: var(--grey-100); margin-top: 16px;">
                        <h5>Availability</h5>
                        <p class="body2">${enabledDays.join(', ')}</p>
                    </div>

                    <div class="card" style="background: var(--grey-100); margin-top: 16px;">
                        <h5>Team Members (${availableTeam.length})</h5>
                        <p class="body2">${availableTeam.map(m => m.name).join(', ')}</p>
                    </div>

                    <div class="card" style="background: var(--grey-100); margin-top: 16px;">
                        <h5>Products (${selectedProducts.length})</h5>
                        <p class="body2">${selectedProducts.join(', ').replace(/_/g, ' ')}</p>
                    </div>

                    <div class="button-group">
                        <button class="button button-text" onclick="prevStep()">Back</button>
                        <button class="button button-contained" onclick="nextStep()">
                            Activate Products
                            <span class="material-icons">check</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function renderDone() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="card card-large text-center">
                    <div style="width: 80px; height: 80px; background: var(--success-light); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 24px;">
                        <span class="material-icons" style="font-size: 48px; color: var(--success-main);">check_circle</span>
                    </div>
                    <h1>You're All Set!</h1>
                    <p class="body1 text-secondary" style="margin: 16px 0 32px;">
                        Your booking products are now active. Customers can start booking appointments right away.
                    </p>

                    <div class="card" style="text-align: left; max-width: 600px; margin: 0 auto;">
                        <h5>Next Steps</h5>
                        <div class="body2" style="margin-bottom: 12px;">
                            <span class="material-icons" style="vertical-align: middle; color: var(--primary-main);">link</span>
                            <strong>Share your booking link:</strong> Add it to your website and social media
                        </div>
                        <div class="body2" style="margin-bottom: 12px;">
                            <span class="material-icons" style="vertical-align: middle; color: var(--primary-main);">phone</span>
                            <strong>Test CSR AI:</strong> Call your number to experience the AI assistant
                        </div>
                        <div class="body2">
                            <span class="material-icons" style="vertical-align: middle; color: var(--primary-main);">settings</span>
                            <strong>Fine-tune settings:</strong> Adjust advanced options in Settings > Booking
                        </div>
                    </div>

                    <div class="button-group" style="justify-content: center; margin-top: 48px;">
                        <button class="button button-outlined" onclick="window.location.reload()">
                            Set Up Another
                        </button>
                        <button class="button button-contained" onclick="alert('Redirecting to dashboard...')">
                            Go to Dashboard
                            <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            `;
        }

        // Service Functions
        function toggleService(id) {
            const service = services.find(s => s.id === id);
            service.enabled = !service.enabled;
            renderStep();
        }

        function filterServices() {
            const search = document.getElementById('serviceSearch').value.toLowerCase();
            const items = document.querySelectorAll('.service-item');
            items.forEach(item => {
                const name = item.querySelector('.service-name').textContent.toLowerCase();
                item.style.display = name.includes(search) ? 'flex' : 'none';
            });
        }

        function addService() {
            const name = prompt('Service name:');
            const price = prompt('Price ($):');
            const duration = prompt('Duration (minutes):');
            if (name && price && duration) {
                services.push({
                    id: services.length + 1,
                    name,
                    price: parseInt(price),
                    duration: parseInt(duration),
                    enabled: true
                });
                renderStep();
            }
        }

        function editService(id) {
            const service = services.find(s => s.id === id);
            const price = prompt('New price:', service.price);
            const duration = prompt('New duration (minutes):', service.duration);
            if (price) service.price = parseInt(price);
            if (duration) service.duration = parseInt(duration);
            renderStep();
        }

        // Schedule Functions
        function toggleDay(day) {
            schedule[day].enabled = !schedule[day].enabled;
            renderStep();
        }

        function updateTime(day, field, value) {
            schedule[day][field] = value;
        }

        // Team Functions
        function toggleTeamMember(id) {
            const member = teamMembers.find(m => m.id === id);
            member.available = !member.available;
            renderStep();
        }

        // Product Functions
        function toggleProduct(id) {
            const index = selectedProducts.indexOf(id);
            if (index > -1) {
                selectedProducts.splice(index, 1);
            } else {
                selectedProducts.push(id);
            }
            renderStep();
        }

        // AI Coach Functions
        function toggleAICoach() {
            const coach = document.getElementById('aiCoach');
            coach.classList.toggle('visible');
        }

        function handleAIInput(event) {
            if (event.key === 'Enter') {
                sendAIMessage();
            }
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const body = document.getElementById('aiCoachBody');
            const message = input.value.trim();

            if (!message) return;

            // User message
            body.innerHTML += `<div class="ai-message" style="background: var(--primary-light); color: white; margin-left: 24px;">${message}</div>`;

            // AI response (mock)
            setTimeout(() => {
                const responses = {
                    'services': 'You have 5 services configured. The most popular is AC Repair at $150. Would you like to adjust pricing?',
                    'hours': 'Your availability is set for Mon-Fri, 8am-5pm. Most HVAC pros also enable Saturday mornings for emergency calls.',
                    'products': 'I recommend starting with Online Booking and CSR AI. You can add Smart Scheduling later as your team grows.',
                    'default': 'Great question! Based on your setup, everything looks good. Is there anything specific you\'d like to change?'
                };

                const response = responses[message.toLowerCase()] || responses.default;
                body.innerHTML += `<div class="ai-message">${response}</div>`;
                body.scrollTop = body.scrollHeight;
            }, 500);

            input.value = '';
            body.scrollTop = body.scrollHeight;
        }

        // Initialize on load
        init();
    </script>
</body>
</html>
